<title>LOSSST</title><meta content="width=device-width,user-scalable=no"name=viewport><script>w=r=d=u=v=s=o=0;trees=[];apples=[];doors=[];cubes=[];hints=[];emoji=[];puzzles=[];aa=0;function ba(){a.style.transform="translateX(-"+g[t]*x+"vh)translateY(-"+y[t]*x+"vh)translateZ(45vh)rotateX(40deg)rotateZ("+aa+"rad)"}var z=position=index=0;function ca(){var k=0;this.h=function(f){k+=f/48E3*Math.PI*2;return k%=2*Math.PI}}function da(k){var f=new ca,q=new ca,n=.1;this.h=function(){if(!k)return 0;var F=k+.4*Math.sin(q.h(3));F=440*Math.pow(2,(F-57)/12);n*=.9998;F=f.h(F);return Math.pow(Math.sin(F),1)*n}}function fa(k){function f(){var f=k.length/2;for(index=position;0>index;)index+=f;index%=f;f=new da(k[2*index+0].charCodeAt(0)-48);for(var F=new da(k[2*index+1].charCodeAt(0)-48),T=[],ea=0;48E3>ea;ea++){var ka=f.h(),qa=F.h(),Ca=.5*ka+qa;T.push(ka+.5*qa);T.push(Ca)}q(T).play()}function q(f){function k(f){f=n(f);return f[0]+f[1]}function n(f){for(var k=0,n="",q=0;4>q;q++,k+=8)n+=String.fromCharCode(f>>k&255);return n}var q=2*f.length;q="RIFF"+n(q+36)+"WAVEfmt "+n(16)+k(1)+k(2)+n(48E3)+n(192E3)+k(4)+k(16)+"data"+n(q);for(var ka in f)q+=k(32767*f[ka]);return new Audio("data:audio/wav;base64,"+btoa(q))}position=-1;this.forward=function(){position++;f()};this.back=function(){position--;f()}}function ha(k){function f(f){f=q(f);return f[0]+f[1]}function q(f){for(var k=0,n="",q=0;4>q;q++,k+=8)n+=String.fromCharCode(f>>k&255);return n}for(var n=[],F=0;;F++){var T=k(F);if(null===T)break;n.push(T)}k=2*n.length;k="RIFF"+q(k+36)+"WAVEfmt "+q(16)+f(1)+f(1)+q(48E3)+q(96E3)+f(2)+f(16)+"data"+q(k);for(F in n)k+=f(1E4*n[F]);return new Audio("data:audio/wav;base64,"+btoa(k))}function ja(k){return 1E4<k?null:(Math.pow(k,1.055)&128?1:-1)*Math.pow((1E4-k)/1E4,2)/2}function la(k){return 25E3<k?null:((k^k>>3^k*k*7.3^k<<4)&65535)/65536*((25E3-k)/25E3)/2}function ma(k){return 5E3<k?null:(Math.pow(k+1E3*Math.sin(.01*k),.8)&200?.5:-.5)*Math.pow((5E3-k)/5E3,1)/2}function na(k){if(16E3<k)return null;var f=Math.pow((16E3-k)/16E3,2.1)/2;return(k<16E3/7?k+10*Math.sin(-k/900)&16:k&13)?f:-f}function oa(k){return 9E4<k?null:(Math.pow(k+1E3*Math.sin(.01*k),.8)&200?.5:-.5)*Math.pow((9E4-k)/9E4,1)/4}var pa=new fa("nbo0risiubv0uisirbs0ui0i0b0c0f0gniojrlsjuivjymvjubv0ui0i0j0m0n0rsgu0vnxnzgx0vnunsg0n0o0n0g0s0o0nrisjulvgufsjufscrbo0ni0j0b0i0j0il`n0ogqgs`u0vgxgz`0gxl0nsouqvsxuuev0u`0`0eq0slulqcs0qcs0qbs0q`s0njo0reseujv0xeveuj0v0e0q0j0i0g0e0cu0scq00bv0ufr0sgn0vbr0xiz0zjr0sgu0vbx0zgx0vbubsg{0zb{`z^{0zi{fzgv0xiu0vjs0ulr0sbn0oll0nbl0jfi0g00bxc0`zb0^{`0]z^0[z]0Zz[0]z^0`zb0]uf0bxi0f{l0izr0ozn0ixr0nrulrnbo0risiufs0r`o0nb0czf0gzi0gzf0cub0i0j0mvn0m0j0irbscrbs`rbs`sbrbo`q0sgugv`x0zg{gz`s0x`s0v`x0vcx0ues0q`l00eu00`x00ev00`u00eq00`o`"),ra=new fa("p0r0sdk0rco0pdk0p0r0sdw0rcs0pdk0p0r0sdk0rck0pdk0p0r0sdw0rcs0pd0f0g0iwg0bwgx0wgurrnspur0bufwgubs0pkrcsdk0rco0pkk0p0r0sdk0rco0pk0l0k0iwg0b0k0g0n0kzs0nxi0f|l0izr0p0n0lwk0dwg0k0p0k|s0pur0kuo0k0i0l0k0isd0krj0kpd0k0p0rsd0krl0opd0f0g0iskw0riw0pgw0nfw0u`s0rbs0pd0k"),C=localStorage,sa=0,D=+C.lossst_s||0,ta=D?ra:pa,E=+C.lossst_m||0,ua=+C.lossst_t||0,va=+C.lossst_M||0,wa=0,xa=0,x=5,t=0,g=[],y=[],G=[],H=[],I=C.lossst_S=+C.lossst_S||5,J=0,K=0,L=null,M="0",N=[],ya=[],za=0,O=0,P=0,Aa=0,Q=0,R=0,S=0,Ba=+C.lossst_T||0,Da=0,U=0,V=0,W="",X=h=0;function Ea(){var k;navigator.userAgent.match(/Mac/)&&(iv.className="a");navigator.userAgent.match(/Fire|Edg/)&&(iv.className+=" c",xa=4E3);E&&(iv.className+=" m");b.className=W;D&&!J&&(ie.innerHTML="");cubes=[];doors=[];trees=[];apples=[];hints=[];emoji=[];if("pz"==W)X=40,h=20,puzzles=[[5,,1,,"0000000000000000000000000",16,9]],I=5,D=0;else if("py"==W)h=X=20,puzzles=[eval("["+location.hash.slice(1).replace(/[01]{2,}/g,'"$&"')+"]")],I=puzzles[0][1],puzzles[0][5]=puzzles[0][6]=8,D=!!puzzles[0][3],hints=[["Move: arrow keys<br>"+(D?"Up/Down: "+(E?"\u2b06\ufe0e/\u2b07\ufe0e":"Shift/Ctrl")+"<br>":"")+"backtrack: "+(E?"\u21a9":"Alt")+"<br>Reset: R",1,5,1,0,D,0]],delete C.lossst_ppy0;else if("px"==W){X=40;h=20;trees=[[13,9,0],[7,13,0],[35,8,0]];apples=[[11,11,0,0,0],[2,12,0,6,0],[38,10,0,7,0]];doors=[[41,10,Math.PI/2,8,0,"pA",1,0,10,0,0],[20,-2,0,14,0,"pD",1,10,19,0,0],[-2,11,-Math.PI/2,6,0,"pJ",1,14,5,1,1],[20,21,Math.PI,14,0,"pC",1,22,1,0,0],[5,21,Math.PI,5,0,"pI",1,36,1,0,1]];puzzles=[];cubes=[];for(f=9;15>f;f++)for(n=0;5>n;n++)2==n&&14==f||2==n&&13==f||3==n&&13==f||3==n&&12==f||2==n&&12==f||cubes.push([n,f]);hints=[["Move with<br>arrow keys"+(E?"":" or WASD/ZQSD"),19,5,0,13,0],["Use the "+(E?"\u21a9":"Alt")+" key to backtrack",1,9,0,13,0,1],["Approach red doors with the right length to open them",35,14,0,13,0],["\u2191<br>New puzzles !<hr>Puzzle editor<br>\u2193",19,8,14,0,0],["New ! Puzzle editor with wraps<br>\u2193",19,8,6,7,1],["\u2190<br>New puzzles !",1,9,6,7,1,1]];emoji=[["\ud83d\udc3f\ufe0f",30,7],["\ud83c\udf30\ufe0f",29,7]]}else if("pA"==W)X=40,h=20,trees=[[35,15,0]],apples=[[33,16,0,0,6],[34,17,0,0,6],[37,15,0,0,6]],cubes=[],doors=[[-2,10,-Math.PI/2,8,0,"px",0,39,11,0,0],[35,21,Math.PI,11,0,"pB",1,35,1,0,0]],puzzles=[[6,,0,,"000000001000001110001110001000000000",2,3],[6,,0,,"000000011000011100010000011000000000",14,3],[6,,0,,"000000000100001100011000011100000000",26,3],[5,,0,,"0000001110011100110000000",2,13],[6,,0,,"000000011000011000001100001100000000",14,13],[6,,0,,"000000000100001100001110001100000000",26,13]],hints=[["Cover the black patterns to solve puzzles",9,9,1,0],["Solve all the puzzles in the room to get new apples and unlock a new door",21,9,1,0],["Your progress is saved automatically",34,9,1,0]],emoji=[["\ud83d\udc0c",11,10]];else if("pB"==W)E&&(kx.className="",C.lossst_r=1),X=40,h=20,trees=[[4,7,0]],apples=[[1,8,0,0,12],[2,9,0,0,12]],doors=[[35,-2,0,8,0,"pA",0,35,19,0,0],[-2,10,-Math.PI/2,13,0,"pC",1,39,10,0,0]],puzzles=[[6,,0,,"000000011110011010011110000000000000",8,2],[7,,0,,"0000000001110000111000001100000110000010000000000",18,2],[6,,0,,"000000011000011110001010001110000000",28,2],[6,,0,,"000000011100001110001110001100000000",8,12],[6,,0,,"000000001110001110001110001010000000",18,12],[6,,0,,"000000011110011110001100001000000000",28,12]],hints=[["If you get stuck, "+(E?"click \u00d7":"press R")+" to exit a puzzle",35,11,1,0],["If a puzzle looks impossible, try another entry !",14,10,1,0]],cubes=[[11,4],[21,16]],emoji=[["\ud83d\udc08",4,14]];else if("pC"==W)X=40,h=20,trees=[[35,8,0]],apples=[[34,11,0,0,18]],doors=[[41,10,Math.PI/2,8,0,"pB",0,1,10,0,0],[22,-2,0,14,0,"px",1,20,19,0,0]],puzzles=[[7,,0,,"0000000000000001111000111100001111000100000000000",2,3],[7,,0,,"0000000001110000101000011100001110000110000000000",26,3],[6,,0,,"000000001110011110011010001110000000",14,3],[7,,0,,"0000000001100000111000011100001110000110000000000",2,12],[7,,0,,"0000000000000001111100101010011111000000000000000",14,12],[6,,0,,"000000011000011100011110011110000000",26,12]],hints=[["\u2191<br>After this room, you can try a puzzle editor and a new kind of puzzles !",22,11,13,0,0]],cubes=[[29,5],[30,8],[17,6],[15,4],[15,7],[29,13],[30,13],[30,14],[18,15],[16,15],[6,13],[6,17],[7,8],[6,8],[5,8],[3,7],[3,8],[7,6],[7,5]],emoji=[["\ud83e\udd8b<br><br>",29,13]];else if("pD"==W){h=X=20;trees=[[10,2,0]];doors=[[10,21,Math.PI,14,0,"px",0,20,0,0,0],[-2,5,-Math.PI/2,14,0,"pE",0,24,12,0,0]];puzzles=[[7,,1,,"0100010011111000000000000000000000001111100100010",7,7]];hints=[["Now you're thinking with wraps !",2,2,0,14,0]];for(f=0;20>f;f++)cubes.push([f,10]);emoji=[["\ud83d\udc10",12,2]]}else if("pE"==W)h=X=25,trees=[[5,12,0]],apples=[[4,14,0,0,23]],doors=[[26,12,Math.PI/2,14,0,"pD",0,0,5,0,0],[-2,12,-Math.PI/2,15,0,"pF",1,79,5,0,0]],puzzles=[[7,,1,,"1000001000000000000000010100011011011000111000001",3,3],[6,,1,,"110011100001000000100001100001110011",15,17],[5,,1,,"1100111001100011001110011",16,4],[6,,1,,"000011000011110001110001000011000011",3,17]],hints=[["Reminder:<br>use "+(E?"\u21a9":"Alt")+" to backtrack,<br>"+(E?"\u00d7":"R")+" to exit a puzzle.",11,14,1,0,0]],emoji=[["\ud83d\udc12",12,20]];else if("pF"==W)X=80,h=20,trees=[[35,10,0]],apples=[[38,11,0,0,35]],doors=[[81,5,Math.PI/2,15,0,"pE",0,0,12,0,0],[-2,15,-Math.PI/2,16,0,"pG",1,19,5,0,0]],puzzles=[[5,,1,,"0111101001010110100011111",59,13],[5,,1,,"1111011000111100001011110",48,13],[5,,1,,"1111101000011110111001100",37,13],[5,,1,,"1111110000111001000011111",26,13],[5,,1,,"1100101101001110011101101",15,13],[5,,1,,"1111100001110010000111111",59,2],[5,,1,,"1000110111100011000111111",48,2],[5,,1,,"1000110101101011111110001",37,2],[5,,1,,"1111110001000110000111111",26,2],[5,,1,,"0111101100011100011011110",15,2],[5,,1,,"1111101111001110001100001",4,8],[5,,1,,"1010100101111010000111111",71,8]],hints=[["This room hides a surprise !",72,2,0,15,0],["\u2190<br>Exit",38,9,16,0,0]],cubes=[],emoji=[];else if("pG"==W)X=20,h=30,trees=[[5,25,0]],apples=[[4,24,0,0,37],[7,25,0,0,37],[2,26,0,0,37],[3,28,0,0,37]],doors=[[21,5,Math.PI/2,16,0,"pF",0,1,15,0,0],[10,31,Math.PI,20,0,"pH",1,10,1,0,0]],puzzles=[[6,,1,,"001000001110111111011100011000001000",7,6],[6,,1,,"110001100001000111000111100001110001",7,18]],emoji=[["\ud83d\udc01",9,14]];else if("pH"==W)X=20,h=30,trees=[[16,22]],apples=[[18,22,0,0,39]],doors=[[10,-2,0,18,0,"pG",0,10,29,0,0],[21,25,Math.PI/2,21,0,"pI",1,1,10,0,0]],puzzles=[[6,,1,,"001000011110111111011110011110001000",7,6],[6,,1,,"110001100001000011000111001111111111",7,18]],emoji=[["\ud83e\udd86",9,14]];else if("pI"==W){X=40;h=20;apples=[[38,2,0,5,0]];doors=[[-2,10,-Math.PI/2,1,0,"pH",0,19,25,0,0],[36,-2,0,6,0,"px",1,5,19,0,1]];puzzles=[];hints=[["Guess what, you finished the first half of the game !",5,9,1,0],["Little snake can move up and down with "+(E?"\u2b06\ufe0e and \u2b07\ufe0e":"Shift and Ctrl keys")+", and open black doors",30,11,1,0]];for(f=0;9>f;f++)cubes.push([30,f]);for(f=30;40>f;f++)cubes.push([f,8]);emoji=[["\ud83d\udc22",13,14]];trees=[[3,1],[15,2],[36,3],[26,5],[25,15],[33,9],[10,12],[36,14],[3,15]]}else"pJ"==W?(X=15,h=70,trees=[[2,62]],apples=[[2,65,0,0,47],[1,66,0,0,47]],doors=[[16,5,Math.PI/2,6,0,"px",0,1,11,0,1],[-2,65,-Math.PI/2,8,0,"pK",1,19,65,0,1]],puzzles=[[5,,0,"0000000000000000000001110",,2,2],[4,,0,"0000000001000110",,4,11],[5,,0,"0000000000000000101001110",,6,20],[5,,0,"0000000000000000111000100",,8,29],[4,,0,"0000000001100110","0000011001100000",2,38],[4,,0,"0000010001100100","0000011001100000",4,47],[4,,0,"0000011001000100","0000010001100000",6,56],[4,,0,"0000000001100110","0100011000100000",8,65]],hints=[["You now have to match the patterns on the walls...",10,2,1,0,1],["... and on the floor too !",10,40,1,0,1],["Beware the gravity: you can't fly !",2,68,1,0,1]],emoji=[["\ud83e\udd89",10,14]]):"pK"==W?(E&&(ky.className=kz.className="",C.lossst_c=1),X=20,h=75,trees=[[2,2]],apples=[[1,4,0,0,59],[2,5,0,0,59],[3,6,0,0,59],[4,2,0,0,59]],doors=[[21,65,Math.PI/2,7,0,"pJ",0,1,65,0,1],[-2,5,-Math.PI/2,12,0,"pL",1,14,5,0,1]],puzzles=[[5,,0,"0000000000010000110001110",,8,69],[6,,0,"000000000000000000000100001110011000",,12,58],[5,,0,"0000000000010000111001000",,2,58],[4,,0,"0000001001100110","0000001001100000",2,45],[5,,0,"0000000000000000010001110","0000000100001100110000000",12,45],[5,,0,"0000000000000000101001110","0000001110010100000000000",2,34],[5,,0,"0000000000000000011001100","0000001110011000010000000",12,34],[4,,1,"0000011001100110","0110000000000110",2,22],[4,,1,"1001000000001001","1001000000001001",12,22],[4,,1,"0000010011110010","0000111101100000",2,12],[4,,1,"0110010000000011","0000011100110000",12,12],[4,,1,"1101000000000001","1101000000010001",12,2]],hints=[["You can rotate the camera with "+(E?"<br>\u21bb and \u21ba":"the keys 1, 2 and 3"),15,68,1,0,1],["Can you guess what's coming next?",7,54,1,0,1],["Yep... 3D puzzles with wrap ! Use "+(E?"\u2b06\ufe0e and \u2b07\ufe0e":"Shift and Ctrl")+" to wrap between top and bottom",7,24,1,0,1]],emoji=[["\ud83d\udc1e",3,70]]):"pL"==W?(X=15,h=80,trees=[[2,70]],apples=[[1,73,0,0,68],[3,75,0,0,68]],doors=[[16,5,Math.PI/2,12,0,"pK",0,1,5,0,1],[-2,75,-Math.PI/2,14,0,"pM",1,14,25,0,1]],puzzles=[[5,,0,"0000000000001001111100100",,2,2],[4,,0,"0000010001100000",,5,11],[5,,0,"0000000110000110111000010",,8,20],[5,,0,"0000000000001000111011111","0000000000111001111100000",2,29],[4,,0,"1000110011101111","0000001111110000",5,38],[4,,0,"0000100011001110","1110110010000000",8,45],[4,,1,"1000100110010001","0000100110010000",2,54],[4,,1,"0000001011110100","0000110011110011",5,63],[5,,1,"0100011000010000111001000","0000001110110000100000000",8,72]],cubes=[[6,12]],emoji=[["\ud83d\udc1d",3,20]]):"pM"==W?(X=15,h=30,trees=[[10,12]],apples=[[8,11,0,0,71],[9,10,0,0,71],[10,9,0,0,71],[11,10,0,0,71],[12,11,0,0,71],[7,12,0,0,71]],doors=[[16,25,Math.PI/2,14,0,"pL",0,1,75,0,1],[-2,5,-Math.PI/2,20,0,"pN",1,14,5,0,1]],puzzles=[[5,,1,"0001100110011001100010000","0001100110011001100010000",2,24],[5,,1,"1100010001000011000111000","0000011000110010000000000",4,13],[5,,1,"1101110001000001000011000","1100010000000001000111011",6,2]],emoji=[["\ud83d\udc13",1,14]]):"pN"==W&&(X=15,h=48,trees=[[10,44]],apples=[[7,45,0,0,75]],doors=[[16,5,Math.PI/2,20,0,"pM",0,1,5,0,1]],puzzles=[[4,,1,"0000111101101111","1000111111111000",5,38],[4,,1,"1111001001001111","1111101010101111",5,28],[4,,1,"1111010101011101","0001101101101111",5,18],[4,,1,"1111000100011110","1111110110011111",5,8]],emoji=[["\ud83d\udc09",13,46]]);a.style.width=X*x+"vh";a.style.height=h*x+"vh";J||(ig.innerHTML="");ih.innerHTML="";for(var f in trees)ig.innerHTML+="<div id=tree"+f+' class="j tr"style=left:'+trees[f][0]*x+"vh;transform:translateX(-7vh)translateY("+(trees[f][1]*x+4)+"vh)rotateX(-70deg)>\ud83c\udf33</div><div id=treeshadow"+f+' class="e h"style=left:'+trees[f][0]*x+"vh;transform:translateX(-7.5vh)translateY("+(trees[f][1]*x+3.5)+"vh)rotateZ(144deg)scaleY(1.5)>\ud83c\udf33";for(f in apples)C["lossst_a"+W+f]?delete apples[f]:ig.innerHTML+="<div id=a"+f+' class="j g '+(C["lossst_A"+W+f]?"":"h")+'"style=left:'+apples[f][0]*x+"vh;transform:translateY("+(apples[f][1]*x+4)+"vh)rotateX(-65deg)>"+("pN"==W?"<div>\u26bd</div>":"<div class=m>\ud83c\udf4e</div>")+"</div><div id=as"+f+' class="e p '+(C["lossst_A"+W+f]?"":"h")+'"style=left:'+apples[f][0]*x+"vh;transform:scaleX(-1)translateY("+(apples[f][1]*x+3)+"vh)rotateZ(212deg)>"+("pN"==W?"\u26bd":"\ud83c\udf4e");for(f in emoji)ig.innerHTML+='<div class="j n"style=left:'+(emoji[f][1]*x-1)+"vh;transform:translateY("+(emoji[f][2]*x+4)+"vh)rotateX(-65deg)><div class=m>"+emoji[f][0];for(f in doors)ig.innerHTML+="<div id=d"+(""+W+f)+' class="do'+(C["lossst_d"+W+f]?" s":"")+'"style=left:'+(doors[f][0]+.5)*x+"vh;top:"+(doors[f][1]+.5)*x+"vh;transform:rotateZ("+doors[f][2]+"rad)translateZ("+doors[f][9]*x+'vh)><div class="y d'+doors[f][10]+'"'+(doors[f][6]?"":"hidden")+">"+doors[f][3]+'</div><div style="position:fixed;width:15vh;height:15vh;background:linear-gradient(transparent,#640 50%);top:-7.4vh;left:-7.5vh">';for(var q in puzzles)for(var n in cubes)C["lossst_p"+W+q]&&cubes[n][0]>=puzzles[q][5]&&cubes[n][0]<puzzles[q][5]+puzzles[q][0]&&cubes[n][1]>=puzzles[q][6]&&cubes[n][1]<puzzles[q][6]+puzzles[q][0]&&delete cubes[n];for(f in cubes)ig.innerHTML+="<div id=cube"+f+' class="z x"style=left:'+cubes[f][0]*x+"vh;top:"+cubes[f][1]*x+'vh;width:5vh;height:5vh><div class=f></div><div class=u style="background-position:'+(-300-cubes[f][0]*x)+"vh "+(-140-cubes[f][1]*x)+'vh"></div><div class=r></div><div class=l></div><div class=b>';for(f in hints)D^hints[f][5]||!(hints[f][3]&&hints[f][3]<=I||hints[f][4]&&hints[f][4]>=I)||(ig.innerHTML+="<div id=h"+(""+W+f)+" class=t style=left:"+hints[f][1]*x+"vh;transform:translateY("+(hints[f][2]*x+5)+"vh)translateZ("+(hints[f][6]*x||0)+"vh)rotateX(-70deg)translateY(-4vh)>"+hints[f][0]);C.lossst_x&&top.hpx0&&(hpx0.style.opacity=1);for(q in puzzles){S=puzzles[q][0];var F=k="";ih.innerHTML+="<div id=puzzle"+q+' class="z q v '+(puzzles[q][2]&&!C["lossst_p"+W+q]?"w":"")+'"style=left:'+puzzles[q][5]*x+"vh;top:"+puzzles[q][6]*x+"vh;width:"+puzzles[q][0]*x+"vh;height:"+S*x+"vh>"+(puzzles[q][2]?"<div class=l></div><div class=r></div>":"")+"<div id=D"+q+" class=d></div><div id=B"+q+" class=b></div>"+(puzzles[q][2]?"<div class=f>":"");var T="000",ea="fff";C["lossst_p"+W+q]&&(T="44c",ea="fd0",puzzles[q][2]=0);for(f=0;f<S;f++)for(n=0;n<S;n++)puzzles[q][3]&&(k+="<div class=o id=w"+q+"-"+f+"-"+n+" style=width:"+x+"vh;height:"+x+"vh;background:#"+("1"==puzzles[q][3][f*S+n]?T:ea)+"></div>"),puzzles[q][4]&&(F+="<div class=o id=g"+q+"-"+f+"-"+n+" style=width:"+x+"vh;height:"+x+"vh;background:#"+("1"==puzzles[q][4][f*S+n]?T:ea)+"></div>");top["D"+q]&&(top["D"+q].innerHTML+=F);top["B"+q]&&(top["B"+q].innerHTML+=k)}"pN"==W&&(ig.innerHTML+="<div style='position:fixed;transform:"+(E?"rotateZ(-90deg)translateX(-87vh)translateY(22vh)translateZ(365vh)":"rotateZ(-90deg)translateX(-83vh)translateY(6vh)translateZ(208vh)")+";font: 30vh/25vh a'>THE<br><br>END");J&&(C.lossst_e||C.lossst_s&&6<C.lossst_S||(ik.style.opacity=im.style.opacity=0,ik.style.position=im.style.position="fixed",ik.style.top=im.style.top="-9vh"),L=0,Y(1),za=1,Aa=P=O=0,puzzles[0][2]=0,setTimeout(function(){(ib.onchange=ib.oninput=resetgrid=function(){Fa();Y();ij.disabled=1;gridval.innerHTML=S=+ib.value;puzzle0.style.width=puzzle0.style.height=S*x+"vh";puzzles[0][0]=S;D0.innerHTML="";F=k=B0.innerHTML="";ya=[];N=[];for(f=0;f<S;f++)for(ya[f]=[],N[f]=[],n=0;n<S;n++)ya[f][n]=0,N[f][n]=0;for(f=0;f<S;f++)for(n=0;n<S;n++)k+="<div class=o id=w"+M+"-"+f+"-"+n+" style=width:"+x+"vh;padding-top:"+x+"vh></div>",F+="<div class=o id=g"+M+"-"+f+"-"+n+" style=width:"+x+"vh;padding-top:"+x+"vh></div>";za&&(D0.innerHTML+=F);O&&(B0.innerHTML+=k)})();iq.onchange=iq.oninput=function(){it.innerHTML=I=+iq.value;Fa();Y()};ik.onclick=function(){ik.checked?za=1:top.m&&(za=0,D=O=1,wall.checked=!0);a.className=O?"haswall":"";resetgrid()};top.m&&(wall.onclick=function(){top.m&&wall.checked?(O=1,D=puzzles[0][3]=1):(O=D=0,za=1,ik.checked=!0,puzzles[0][3]=0);a.className=O?"haswall":"";resetgrid()});top.A&&(wrap.onclick=function(){P=puzzles[0][2]=wrap.checked||0;puzzle0.className="z q v "+(P?"w":"");resetgrid()});print=function(k){var q="";for(f=0;f<S;f++)for(n=0;n<S;n++)q=top[k+"0-"+f+"-"+n].style.background&&top[k+"0-"+f+"-"+n].style.background.match(/255/)?q+0:q+1;return q};ij.onclick=function(){var f=[];f.push(S);f.push(I);f.push(P?1:0);f.push(O?print("w"):"");f.push(ik.checked?print("g"):"");open("//twitter.com/intent/tweet?text=I%20made%20a%20level%20for%20@MaximeEuziere's%20%23js13k%20game%20LOSSST!%0APlay%20here:%20js13kgames.com%2Fentries%2Flossst%0AMy%20level:%20js13kgames.com%2Fgames%2Flossst%23"+f+"%0A%23LOSSSTlevels")}},100));"px"!=W||C.lossst_x?(a.style.transition="transform 1s,transform-origin 1s",Fa()):(K=1,setTimeout(function(){Fa();Y();M0.style.transition="transform .5s"},2E3),setTimeout(function(){g.push(g[t]);y.push(y[t]);G.push(0);H.push(H[t]);t++;Y()},5500+xa),setTimeout(function(){M0.style.transition="";R0.style.transition="transform .2s";R0.style.transform="rotateZ("+-Math.PI/4+"rad)"},6500+xa),setTimeout(function(){R0.style.transform="rotateZ("+Math.PI/4+"rad)"},7E3+xa),setTimeout(function(){R0.style.transform=""},7500+xa),setTimeout(function(){S0.style.transition=R0.style.transition=""},8E3+xa),setTimeout(function(){clearInterval(z);sa||(K=0);hpx0.style.opacity=1},8400),setTimeout(function(){a.style.transition="transform 1s,transform-origin 1s";C.lossst_x=20;C.lossst_y=10;b.innerHTML+="<div style='position:fixed;font:8vh a;top:3vh;right:3vh'onclick=location='index.html'>\u00d7";E&&(kU.className=kD.className=kL.className=kR.className="",C.lossst_w=1)},9E3));Y()}function Fa(){var k=D&&!J?ia:ie;k.innerHTML="";g=[];y=[];G=[];H=[];t=I-1;if("py"==W)for(i=0;i<I;i++)g[t-i]=1-i,y[t-i]=10,G[t-i]=0,H[t-i]=-Math.PI/2;else if(J)for(i=0;i<I;i++)g[t-i]=13-i,y[t-i]=12,G[t-i]=0,H[t-i]=-Math.PI/2;else if(C.lossst_x){var f=+C.lossst_x,q=+C.lossst_y,n=+C.lossst_z;"px"==W&&2>C.lossst_x&&(n=C.lossst_z=1);if("pI"==W&&sa&&1==D)for(i=0;i<I;i++)g[t-i]=20,y[t-i]=10,G[t-i]=-i-1,H[t-i]=0;else if(2>f)for(i=0;i<I;i++)g[t-i]=f-i,y[t-i]=q,G[t-i]=n,H[t-i]=-Math.PI/2;else if(f>X-2)for(i=0;i<I;i++)g[t-i]=f+i,y[t-i]=q,G[t-i]=n,H[t-i]=Math.PI/2;else if(2>q)for(i=0;i<I;i++)g[t-i]=f,y[t-i]=q-i,G[t-i]=n,H[t-i]=0;else if(q>h-2)for(i=0;i<I;i++)g[t-i]=f,y[t-i]=q+i,G[t-i]=n,H[t-i]=0;else for(i=0;i<I;i++)g[t-i]=20,y[t-i]=10,G[t-i]=-i,H[t-i]=0}else if("px"==W)for(i=0;i<I;i++)g[t-i]=20,y[t-i]=10,G[t-i]=-i-1,H[t-i]=0;for(i=0;i<Math.max(I+4,16);i++)k.innerHTML+="<div id=M"+i+" class=sm style=transform:translateX(50vh)translateY(50vh)translateZ(-30vh);width:"+(x-.7)+"vh;height:"+(x-.7)+"vh><div class=ss id=S"+i+"></div><div id=R"+i+' class=sr><div class="z k"id=T'+i+">"+(1>i?"<div style=background:none;box-shadow:none;color:red;font-size:4vh;text-align:center;transform:rotateZ(180deg)translateY(-4vh)translateZ(1.5vh)>Y</div>":"")+'<div class=u style="font:'+.5*x+"vh/"+.8*x+'vh a">'+(1>i?"\ud83d\udc40":"")+"</div><div class=f>"+(1>i?"\u203f":"")+"</div><div class=r></div><div class=l></div><div class=b>"}function Y(k){for(var f={a:0};f.a<I;f={a:f.a,i:f.i,j:f.j,l:f.l},f.a++)if(!k){var q=oldx=oldy=oldz=newx=newy=newz=0;P&&S&&(g[t-f.a-1]==Q&&g[t-f.a]==Q+S-1?(q=1,oldx=Q-1,newx=Q+S,oldy=newy=y[t-f.a],oldz=newz=G[t-f.a]):g[t-f.a-1]==Q+S-1&&g[t-f.a]==Q?(q=1,oldx=Q+S,newx=Q-1,oldy=newy=y[t-f.a],oldz=newz=G[t-f.a]):y[t-f.a-1]==R&&y[t-f.a]==R+S-1?(q=1,oldy=R-1,newy=R+S,oldx=newx=g[t-f.a],oldz=newz=G[t-f.a]):y[t-f.a-1]==R+S-1&&y[t-f.a]==R?(q=1,oldy=R+S,newy=R-1,oldx=newx=g[t-f.a],oldz=newz=G[t-f.a]):0==G[t-f.a-1]&&G[t-f.a]==S-1?(q=1,oldz=-1,newz=S,oldx=newx=g[t-f.a],oldy=newy=y[t-f.a]):G[t-f.a-1]==S-1&&0==G[t-f.a]&&(q=1,oldz=S,newz=-1,oldx=newx=g[t-f.a],oldy=newy=y[t-f.a]));if(q)top["R"+f.a].style.transform="rotateZ("+H[t-f.a]+"rad)",top["M"+f.a].style.transform="translateX("+(oldx*x+.5)+"vh)translateY("+(oldy*x+.5)+"vh)translateZ("+(oldz*x+.5)+"vh)scale(.01)scaleZ(.01)",setTimeout(function(f){return function(){top["M"+f.a].style.transition="none"}}(f),90),f.i=newx,f.j=newy,f.l=newz,setTimeout(function(f){return function(){top["M"+f.a].style.transform="translateX("+(f.i*x+.5)+"vh)translateY("+(f.j*x+.5)+"vh)translateZ("+(f.l*x+.5)+"vh)scale(.01)"}}(f),100),setTimeout(function(f){return function(){top["M"+f.a].style.transition="";top["M"+f.a].style.transform="translateX("+(g[t-f.a]*x+.25)+"vh)translateY("+y[t-f.a]*x+"vh)translateZ("+(G[t-f.a]*x+.5)+"vh)"}}(f),150);else try{top["M"+f.a].style.transform="translateX("+(g[t-f.a]*x+.25)+"vh)translateY("+y[t-f.a]*x+"vh)translateZ("+(G[t-f.a]*x+.5)+"vh)",top["R"+f.a].style.transform="rotateZ("+H[t-f.a]+"rad)"}catch(F){}try{top["S"+f.a].style.display=0==G[t-f.a]?"":"none"}catch(F){}}J?a.style.transform="translateX(-100vh)translateY(-37vh)translateZ(-5vh)rotateX(33deg)":null===L||C["lossst_p"+W+L]?(a.style.transform="translateX("+-g[t]*x+"vh)translateY("+-y[t]*x+"vh)translateZ(45vh)rotateX(40deg)rotateZ("+aa+"rad)",a.style.transformOrigin=""+g[t]*x+"vh "+y[t]*x+"vh"):(a.style.transform="translateX("+(-(Q+puzzles[L][0]/2)*x+5)+"vh)translateY("+(-(R+puzzles[L][0]/2)*x+8)+"vh)translateZ("+(90-puzzles[L][0]*(x+3))+"vh)rotateX(30deg)rotateZ("+aa+"rad)",a.style.transformOrigin=""+((Q+puzzles[L][0]/2)*x+5)+"vh "+((R+puzzles[L][0]/2-1)*x+8)+"vh");f=D?1:0;for(k=0;k<I;k++){if(0>=G[t-k]){f=0;break}for(n in cubes)cubes[n][0]==g[t-k]&&cubes[n][1]==y[t-k]&&1==G[t-k]&&(f=0)}if(f){for(k=0;k<I;k++)G[t-k]--;try{Y()}catch(F){for(var n=2*I;n--;)g.pop(),y.pop(),G.pop(),H.pop(),t--;Da=0;Y()}}f=g[t];q=y[t];for(k in doors)(doors[k][10]&&D||!doors[k][10]&&!D)&&top["door"+W+k]&&0<doors[k][3]&&I>=doors[k][3]&&4>Math.hypot(f-doors[k][0],q-doors[k][1])&&!C["lossst_d"+W+k]&&(top["d"+W+k].className="do s",!doors[k][6]||"px"==W&&2<k||ha(oa).play(),C["lossst_d"+W+k]=1),top["d"+W+k]&&"do s"==top["d"+W+k].className&&2>Math.hypot(f-doors[k][0],q-doors[k][1])&&(C.lossst_p=W=doors[k][5],setTimeout(Ea,600),C.lossst_x=doors[k][7],C.lossst_y=doors[k][8],C.lossst_z=0);null!==L&&Ga();J||(L=null);J||(N=[],ya=[]);for(p in puzzles)if(f>=puzzles[p][5]&&f<puzzles[p][5]+puzzles[p][0]&&q>=puzzles[p][6]&&q<puzzles[p][6]+puzzles[p][0]){L=+p;Aa=0;C["lossst_p"+W+p]&&(Aa=1);M=p;za=!!puzzles[p][4];O=!!puzzles[p][3];P=!!puzzles[p][2];Q=puzzles[p][5];R=puzzles[p][6];S=puzzles[p][0];for(k=0;k<S;k++)for(N[k]=[],ya[k]=[],n=0;n<S;n++)puzzles[p][3]&&(ya[k][n]=+puzzles[p][3][k*puzzles[p][0]+n]),puzzles[p][4]&&(N[k][n]=+puzzles[p][4][k*puzzles[p][0]+n]);Ga()}}function Z(k,f,q){V=0;if(0>k||k>=X||0>f||f>=h)V=1;for(var n in trees)k>=trees[n][0]-1&&k<=trees[n][0]&&f==trees[n][1]&&3>G[t]&&(V=1);for(n in hints)k>=hints[n][1]&&k<=hints[n][1]+3&&f==hints[n][2]&&I>=hints[n][3]&&(!hints[n][4]||I<=hints[n][4])&&(D&&hints[n][5]||!D&&!hints[n][5])&&(V=1);for(n in apples)if(C["lossst_A"+W+n]&&k==apples[n][0]&&f==apples[n][1]&&0==G[t])if(ha(ja).play(),"pN"==W){z=setInterval(ta.forward,150);C.lossst_E=1;setTimeout(function(){K=1;as0.remove();a0.style.transform="translateY(319vh)translateZ(2vh)rotateX(-65deg)rotateY(90deg)";a0.style.transition=a.style.transition="10s";a0.style.transform="translateY(15vh)translateZ(2vh)rotateX(-65deg)";a.style.transform=E?"translateX(-133vh)translateY(-249vh)translateZ(-373vh)rotateZ(90deg)":"translateX(-141vh)translateY(-227vh)translateZ(-185vh)rotateZ(90deg)"},200);var F={},T;for(T in puzzles)F.f=T,setTimeout(function(f){return function(){top["B"+f.f].style.transition=".5s";top["B"+f.f].style.transform="translateY(-125%)"}}(F),[1450,2500,3800,5400][F.f]),F={f:F.f};setTimeout(function(){clearInterval(wa);C.lossst_E=1;C.lossst_e=1;b.style.background="#000";C.lossst_s=0;b.innerHTML="<div id=iv style=perspective:90vh><center id=menu style=width:75vh;transform:translateX(-38vh)translateY(-35vh)rotateX(-28deg)><span style=font-size:4vh;line-height:5vh><h1>Congrats!</h1><br>You completed the game in<br>"+ua+" seconds and "+va+" moves!<br><br><a href=//twitter.com/intent/tweet?text=I%20played%20LOSSST,%20a%20%23js13k%20game%20by%20by%20@MaximeEuziere%0Amy%20score:%20"+ua+"%20seconds%20and%20"+va+"%20moves!%0Ajs13kgames.com%2Fentries%2Flossst target=_blank style=color:#def;font-size:4vh>TWEET YOUR SCORE</a><br><br>Dev record:<br>936 seconds, 2554 moves<br><br><a href=. style=font-size:4vh>try the 3D puzzle editor"},15E3);q=document.querySelectorAll(".o");F={};for(var ea in q){F.g=ea;try{2==q[F.g].style.backgroundColor.match(/68/g).length&&setTimeout(function(f){return function(){top[q[f.g].id].style.background="#a00"}}(F),8E3+10*F.g)}catch(qa){}F={g:F.g}}}else if(delete apples[n],top["a"+n].remove(),top["as"+n].remove(),I++,C.lossst_S=I,C["lossst_a"+W+n]=1,"pF"==W&&16==I){K=1;z=setInterval(ta.forward,150);sa=1;a.style.transition="5s";a.style.transform="translateX(-180vh)translateY(-53vh)translateZ("+(E?-422:-180)+"vh)rotateZ(180deg)";setTimeout(function(){a.style.transition="1s";K=sa=0;Y();ig.innerHTML+="<div class=t style=left:190vh;transform:translateY(50vh)rotateX(-55deg)translateY(-4vh)>\u2190<br>Exit";clearInterval(z)},1E4);q=document.querySelectorAll(".o");F={};for(var ka in q){F.c=ka;try{q[F.c].id.match(/g\d-/)&&2==q[F.c].style.backgroundColor.match(/68/g).length&&setTimeout(function(f){return function(){top[q[f.c].id].style.background="#a00"}}(F),5500+10*F.c)}catch(qa){}F={c:F.c}}}for(n in cubes)k==cubes[n][0]&&f==cubes[n][1]&&0==q&&(V=1);for(n in emoji)"pC"!=W&&k==emoji[n][1]&&f==emoji[n][2]&&0==q&&(V=1);for(n in doors)top["d"+W+n]&&"do s"==top["d"+W+n].className&&2>=Math.hypot(k-doors[n][0],f-doors[n][1])&&(V=0);hitcube2=0;for(n=I-2;0<n;n--)g[t-n]==k&&y[t-n]==f&&G[t-n]==q&&(V=1,1==n&&(hitcube2=1));for(p in puzzles)puzzles[p][3]&&k>=puzzles[p][5]&&k<puzzles[p][5]+puzzles[p][0]&&(f==puzzles[p][6]-1&&y[t]==puzzles[p][6]&&!puzzles[p][2]||f==puzzles[p][6]&&y[t]==puzzles[p][6]-1)&&(V=1);if("pI"==W&&18==k&&!D){sa=D=V=K=1;clearInterval(z);ta=ra;index=position=0;z=setInterval(ra.forward,250);C.lossst_s=1;C.lossst_S=I=5;for(k=0;21>k;k++)cubes.push([g[t-k],y[t-k]]),top["M"+k].id="",top["R"+k].id="",top["S"+k].id="",top["T"+k].id="";a.style.transition="2s";Fa();Y();a.style.transform="translateX(-105vh)translateY(-51vh)translateZ(80vh)rotateX(45deg)";a.style.transformOrigin="140vh 70vh";setTimeout(function(){g.push(g[t]);y.push(y[t]);G.push(0);H.push(H[t]);t++;Y()},3E3);setTimeout(function(){ii.innerHTML="Daddy!"},4E3);setTimeout(function(){ii.innerHTML=""},6E3);setTimeout(function(){ii.innerHTML="I lossst my soccer ball!"},7E3);setTimeout(function(){ii.innerHTML=""},9E3);setTimeout(function(){ii.innerHTML="But I found new moves!"},1E4);setTimeout(function(){ii.innerHTML="";sa=K=0;clearInterval(z);a.style.transition="1s";Y();Ha();E&&(kT.className=kB.className="",C.lossst_B=1)},13500)}}function Ga(){if(!Aa&&null!==L){solved=1;J&&(ij.disabled=0);for(i=0;i<S;i++)for(j=0;j<S;j++)try{top["g"+M+"-"+i+"-"+j]&&(top["g"+M+"-"+i+"-"+j].style.background=N[i][j]?"#000":"#fff"),top["w"+M+"-"+i+"-"+j]&&(top["w"+M+"-"+i+"-"+j].style.background=ya[i][j]?"#000":"#fff")}catch(n){}if(g[t]<Q||g[t]>Q+S-1||y[t]<R||y[t]>R+S-1||0>G[t]||G[t]>S-1)J&&(ij.disabled=1);else{for(i=0;i<I;i++){top["g"+M+"-"+(y[t-i]-R)+"-"+(g[t-i]-Q)]&&(top["g"+M+"-"+(y[t-i]-R)+"-"+(g[t-i]-Q)].style.background=N[y[t-i]-R][g[t-i]-Q]?"#080":J?"#44c":"#f00");y[t-i]>=R&&y[t-i]<R+S&&top["w"+M+"-"+(S-1-G[t-i])+"-"+(g[t-i]-Q)]&&(top["w"+M+"-"+(S-1-G[t-i])+"-"+(g[t-i]-Q)].style.background=ya[S-1-G[t-i]][g[t-i]-Q]?"#080":J?"#44c":"#f00");if(g[t-i]<Q||g[t-i]>Q+S-1||y[t-i]<R||y[t-i]>R+S-1||G[t-i]>S-1)J&&(ij.disabled=1),solved=0;za&&N[y[t-i]-R]&&!N[y[t-i]-R][g[t-i]-Q]&&(solved=0);O&&ya[S-1-G[t-i]]&&!ya[S-1-G[t-i]][g[t-i]-Q]&&(solved=0)}for(i=0;i<S;i++)for(j=0;j<S;j++){try{za&&3==top["g"+M+"-"+i+"-"+j].style.backgroundColor.match(/0/g).length&&(solved=0)}catch(n){}try{O&&3==top["w"+M+"-"+i+"-"+j].style.backgroundColor.match(/0/g).length&&(solved=0)}catch(n){}}if(solved){Aa=J?0:1;puzzles[L][2]=0;top["puzzle"+L].classList.remove("w");J||(C["lossst_p"+W+L]=1);for(i=0;i<S;i++)for(j=0;j<S;j++){try{top["g"+M+"-"+i+"-"+j].style.background=N[i][j]?"#44c":"#fd0"}catch(n){}try{top["w"+M+"-"+i+"-"+j].style.background=ya[i][j]?"#44c":"#fd0"}catch(n){}}J||(ha(na).play(),Ba++,C.lossst_T=Ba);var k=1,f={},q;for(q in cubes)f.b=q,cubes[f.b][0]>=puzzles[L][5]&&cubes[f.b][0]<puzzles[L][5]+puzzles[L][0]&&cubes[f.b][1]>=puzzles[L][6]&&cubes[f.b][1]<puzzles[L][6]+puzzles[L][0]&&(delete cubes[f.b],k++,setTimeout(function(f){return function(){top["cube"+f.b].remove()}}(f),200*k)),f={b:f.b}}}}}function Ha(){for(var k in apples)if(!C["lossst_A"+W+k]&&(0<apples[k][3]&&apples[k][3]==I||0<apples[k][4]&&apples[k][4]==Ba)){K=1;E&&"px"==W&&1==k&&(kw.className="",C.lossst_b=1);var f=setTimeout;a.style.transform="translateX("+-apples[k][0]*x+"vh)translateY("+-apples[k][1]*x+"vh)translateZ(50vh)rotateX(35deg)";C["lossst_A"+W+k]=1;a.style.transformOrigin=""+apples[k][0]*x+"vh "+apples[k][1]*x+"vh";f(void 0,250);f=setTimeout;top["a"+k].className="j g";top["as"+k].className="e p";f(void 0,800);setTimeout(function(){ha(la).play()},850);setTimeout(function(){Y();sa||(K=0)},2E3)}}function Ia(){U=0;J||(L=null);for(p in puzzles)g[t]>=puzzles[p][5]&&g[t]<puzzles[p][5]+puzzles[p][0]&&y[t]>=puzzles[p][6]&&y[t]<puzzles[p][6]+puzzles[p][0]&&0<=G[t]&&G[t]<puzzles[p][0]&&(L=+p,U=1)}onkeydown=function(k){top["lurd************************l**r************l*d***u**u"[k.which-37]]=1;18==k.which&&(B=1);16==k.which&&(s=1);17==k.which&&(c=1);if(!K){if(49==k.which||97==k.which)-1<aa&&aa--,ba();if(50==k.which||98==k.which)aa=0,ba();if(51==k.which||99==k.which)1>aa&&aa++,ba()}Ia();U?Ga():Da=0;if(82==k.which&&U){if(Da<=t)for(var f=Da;f<=t;f++)g.pop(),y.pop(),G.pop(),H.pop(),setTimeout(function(){ta.back()},70*(t-f));t=Da-1;Da=0;Y();Ga();C.lossst_M=++va}else if(116!=k.which&&82!=k.which&&17!=k.which&&123!=k.which&&k.preventDefault&&k.preventDefault(),!K){V=0;if(l)!Aa&&P&&U&&g[t]==Q?(Z(Q+S-1,y[t],G[t]),V||(g.push(Q+S-1),y.push(y[t]),G.push(G[t]),H.push(Math.PI/2),t++)):(Z(g[t]-1,y[t],G[t]),V||(g.push(g[t]-1),y.push(y[t]),G.push(G[t]),H.push(Math.PI/2),t++));else if(r)!Aa&&P&&U&&g[t]==Q+S-1?(Z(Q,y[t],G[t]),V||(g.push(Q),y.push(y[t]),G.push(G[t]),H.push(-Math.PI/2),t++)):(Z(g[t]+1,y[t],G[t]),V||(g.push(g[t]+1),y.push(y[t]),G.push(G[t]),H.push(-Math.PI/2),t++));else if(u)!Aa&&P&&U&&y[t]==R?(Z(g[t],R+S-1,G[t]),V||(g.push(g[t]),y.push(R+S-1),G.push(G[t]),H.push(Math.PI),t++)):(Z(g[t],y[t]-1,G[t]),V||(g.push(g[t]),y.push(y[t]-1),G.push(G[t]),H.push(Math.PI),t++));else if(d)!Aa&&P&&U&&y[t]==R+S-1?(Z(g[t],R,G[t]),V||(g.push(g[t]),y.push(R),G.push(G[t]),H.push(0),t++)):(Z(g[t],y[t]+1,G[t]),V||(g.push(g[t]),y.push(y[t]+1),G.push(G[t]),H.push(0),t++));else if((D||O)&&s){if(!U){k=I-1;for(f in cubes)cubes[f][0]==g[t]&&cubes[f][1]==y[t]&&k++;if(G[t]==k)return}!Aa&&P&&U&&G[t]==S-1?(Z(g[t],y[t],0),V||(g.push(g[t]),y.push(y[t]),G.push(0),H.push(H[t]),t++)):(Z(g[t],y[t],G[t]+1),V||(g.push(g[t]),y.push(y[t]),G.push(G[t]+1),H.push(H[t]),t++))}else(D||O)&&c?!Aa&&P&&U&&0==G[t]?(Z(g[t],y[t],S-1),V||(g.push(g[t]),y.push(y[t]),G.push(S-1),H.push(H[t]),t++)):0==G[t]?V=1:(Z(g[t],y[t],G[t]-1),V||(g.push(g[t]),y.push(y[t]),G.push(G[t]-1),H.push(H[t]),t++)):B&&t>I&&(H.pop(),g.pop(),y.pop(),G.pop(),t--);V&&!K&&(K=1,setTimeout(function(){sa||(K=0)},150),!(-1<g[t]&&g[t]<X&&-1<y[t]&&y[t]<h)||"pI"==W&&!D&&16<g[t]||hitcube2||ha(ma).play());if(!V&&!sa&&(u||r||d||l||s||c||B)){C.lossst_M=++va;Ga();Y();B?t>I&&ta.back():(D||!s&&!c&&!D)&&ta.forward();Y(1);Ha();K||(K=1,setTimeout(function(){sa||(K=0)},150));if("px"==W&&(D||14<=I)&&20==g[t]&&10==y[t]){K=1;var q=0;for(f=0;f<I;f++)setTimeout(function(){g.push(g[t]);y.push(y[t]);G.push(--q);H.push(H[t]);t++;Y()},150*f);setTimeout(function(){indexx("pz",1)},160*I);C.lossst_x=20;C.lossst_y=10}Ia();U&&!Da&&(Da=t)}}};onkeyup=function(){u=r=d=l=s=c=B=0};onload=function(){1<location.hash.length?indexx("py",1):(setTimeout(function(){z=setInterval(function(){ta.forward()},500)},200),b.innerHTML="<center id=e>\ud83d\udc40</center>\n<center id=iw></center>\n<div id=iv style=perspective:30vh>\n<center id=menu>\n<h1>LOSSST</h1>\n<span onclick=newgame()>New game</span><br>\n"+(C.lossst_a&&!C.lossst_E?"<span onclick=indexx(0,1)>Continue</span><br>":"")+"\n<span onclick=indexx(\"pz\",1)>Puzzle editor</span><br>\n<span onclick=window.open('//xem.github.io/JS13k17/bonus')>Bonus",newgame=function(){for(i in localStorage)0==i.indexOf("lossst")&&-1==i.indexOf("e")&&delete localStorage[i];C.lossst_a=1;menu.innerHTML="<br><br><span onclick=intro(0)>Desssktop</span><br><br><span onclick=intro(1)>Mobile"},intro=function(k){clearInterval(z);index=position=0;z=setInterval(ta.forward,250);C.lossst_m=E=k;C.lossst_S=I=5;ua=C.lossst_t=0;va=C.lossst_M=0;C.lossst_M=0;C.lossst_t=0;menu.innerHTML="";setTimeout(function(){e.style.margin=0},500);dir=1;inter=setInterval(function(){e.style.opacity=0;setTimeout(function(){e.style.opacity=1;dir=-dir;e.style.transform="scaleX("+dir+")"},150)},3E3);setTimeout(function(){iw.innerHTML="I lossst my kid !"},2E3);setTimeout(function(){iw.innerHTML=""},5E3);setTimeout(function(){clearInterval(inter);e.style.margin="-80vh 0 0"},7E3);setTimeout(indexx,7500)})};window.indexx=function(k,f){if(0===k||"pz"==k)clearInterval(z),index=position=0;"pz"==k&&(J=1,L=0);W=k||C.lossst_p||"px";document.body.outerHTML="<body id=b class="+W+">\n<div id=iv>\n<div id=a style=transform:translateX(-97vh)translateY(-50vh)rotateZ(90deg)translateZ(119vh);transform-origin:100vh+50vh>\n<div id=ig>"+(J?"<div class=t style=width:60vh;transform:translateX(70vh)translateY(1vh)translateZ(2vh)rotateX(-42deg)>\n<label style=width:100%;text-align:center>Create a pattern with the snake and share it !</label>\n<br style=line-height:6vh>\n<div style=text-align:left;padding-left:5vh>\n<label>Grid</label> <input id=ib type=range value=5 min=3 max=8 step=1>\n<span id=gridval>5</span>\n<br>\n<label>Snake</label> <input id=iq type=range value=5 min=5 max=40 step=1>\n<span id=it>5</span>\n</div>\n<input type=checkbox id=ik checked> <label for=ik id=im>ground</label>\n"+(C.lossst_e||C.lossst_s&&6<C.lossst_S?"<input type=checkbox id=wall> <label for=wall>wall</label>":"")+"\n"+(C.lossst_e||C.lossst_s?"<input type=checkbox id=wrap> <label for=wrap>wrap</label>":"")+"\n<br>\n<center>\n<button id=ij disabled>Share</button>\n</center>\n</div>":"")+"\n</div>\n<div id=ih></div>\n<div id=ie></div>\n<div id=ia></div>\n</div>\n</div>\n<center id=iz style='font:5vh arial,sans-serif;color:#fff;position:fixed;bottom:9vh;left:0;width:100vw'>\n<button id=kU class=h ontouchstart=touchstart(38) ontouchend=touchend(38)>\u2191</button>\n<button id=kD class=h ontouchstart=touchstart(40) ontouchend=touchend(40)>\u2193</button>\n<button id=kL class=h ontouchstart=touchstart(37) ontouchend=touchend(37)>\u2190</button>\n<button id=kR class=h ontouchstart=touchstart(39) ontouchend=touchend(39)>\u2192</button>\n<button id=kT class=h ontouchstart=touchstart(16) ontouchend=touchend(16)>\u2b06\ufe0e</button>\n<button id=kB class=h ontouchstart=touchstart(17) ontouchend=touchend(17)>\u2b07\ufe0e</button>\n<button id=kw class=h ontouchstart=touchstart(18) ontouchend=touchend(18)>\u21a9</button>\n<button id=kx class=h ontouchstart=touchstart(82) ontouchend=touchend(82)>\u00d7</button>\n<button id=ky class=h ontouchstart=touchstart(49) ontouchend=touchend(49)>\u21bb</button>\n<button id=kz class=h ontouchstart=touchstart(51) ontouchend=touchend(51)>\u21ba</button>\n</center>\n<center id=ii style='font:5vh arial,sans-serif;color:#fff;position:fixed;bottom:9vh;left:0;width:100vw'>";C.lossst_Apx0=1;Ea();if(E&&"py"==W||C.lossst_w)kU.className=kD.className=kL.className=kR.className="";if(E&&"py"==W||C.lossst_b)kw.className="";if(E&&"py"==W||C.lossst_r)kr.className="";if(E&&"py"==W||C.lossst_B)kT.className="",kB.className="";if(E&&"py"==W||C.lossst_c)ky.className="",kz.className="";J||(wa=setInterval(function(){C.lossst_t=++ua},1E3));f&&(b.innerHTML+="<div style='position:fixed;font:8vh a;top:3vh;right:3vh'onclick=location='.'>\u00d7")}</script><style>@keyframes move{0%,100%{transform:rotateY(-10deg)}50%{transform:rotateY(10deg)}}*{margin:0;padding:0;font:2.5vh/5.5vh arial,sans-serif;vertical-align:middle;box-sizing:border-box;-webkit-touch-callout:none;-webkit-user-select:none;-webkit-tap-highlight-color:transparent;user-select:none;cursor:pointer;touch-action:manipulation}html,body{height:100%;background:#000;overflow:hidden;background:radial-gradient(#def 25%,#7ce)}a{color:#def}input,button{position:relative;z-index:2}input[type=range]::-webkit-slider-runnable-track,input[type=range]::-webkit-slider-thumb{background:#888;border:1px solid #000}input[type=range]::-moz-range-track,input[type=range]::-moz-range-thumb{background:#888;border:1px solid #000}#iv{width:0;height:0;perspective:120vh;position:absolute;top:50%;left:50%}#iv *{transform-style:preserve-3d}#a{width:0;height:0;transform-origin:18vh 0%;transition:transform 1s,transform-origin 1s}.z{position:fixed;top:0;left:0}.z>div{width:100%;height:100%;position:fixed}.z .u{transform:rotateY(90deg)translateX(-100%)rotateY(-90deg)}.z .l{transform:rotateX(-90deg)translateY(-50%)translateX(-50%)rotateY(-90deg)}.z .r{transform:rotateX(-90deg)translateY(-50%)translateX(50%)rotateY(90deg)}.z .f{transform:translateY(50%)rotateX(-90deg)translateY(-50%)}.z .b{transform:translateY(-50%)rotateX(-90deg)translateY(-50%)rotateY(180deg)}.z.q{width:32vh;height:32vh;transform:none}.z.q>div{background:transparent}.z.q .b{transition:opacity .5s;transform:translateY(-50%)rotateX(-90deg)translateY(-52%)}.z.q.w .d,.z.q .d{transition:opacity .5s;background:#0c5b0c}.sm,.sr{transform-origin:50% 50%;width:100%;height:100%;position:fixed}.sm{transition:transform .15s}.z.k{width:100%;height:100%}.z.k>div{box-shadow:0 0 0 .1vh #000 inset;text-align:center}.z.k .f{line-height:3vh}#ie .z.k>div{background:#FFA500}#ie .z.k .u{background:#dF8500}#ia .z.k>div,#a.haswall .z.k>div{background:#444}#ia .z.k .u,#a.haswall .z.k .u{background:#333}#ia .z.k .f{color:#fff}.ss{position:fixed;width:100%;height:100%;background:rgba(0,0,0,.25);transform:translateX(14%)translateY(14%)translateZ(-.25vh)}label{display:inline-block;width:22%}button{display:inline-block;width:23%;border:.2vh solid #000;margin:1vh 2% 0 0}input[type=range]{width:60%}#form{width:50vh;margin:auto}.o{float:left;outline:.4vh solid #888;opacity:0;transition:opacity .5s;background:#fff}.z.q.v{transform:translateZ(.1vh)}.z.q.v .o{opacity:1}.z.q.v .d{transform:none}.z.q.w>div{background:linear-gradient(45deg,rgba(200,200,200,.1),rgba(200,200,200,.3));box-shadow:0 0 .1vh rgba(255,255,255,.5)}.j{position:fixed;transform-origin:50% 100%;bottom:0}.m{animation:move 3s infinite}.e{color:rgba(0,0,0,.002);text-shadow:0px 0px rgba(0,0,0,.25);position:fixed;transform-origin:50% 100%;bottom:0}.tr,.h{font:11vh/12vh a}.a .tr{font:15vh/11vh a}.a .h,.c .h,.i .h,.a .p,.c .p,.i .p,.c .x.b,#iz button.h{display:none}.g,.g *,.p{font:4vh/5vh a;transition:opacity .5s .5s}.n,.n *{font:5vh/6vh a}.g.h,.p.h{opacity:0}.a .g{font:6vh/5vh a}.do{position:fixed;transform-origin:0% 100%;width:0;height:0}.do .y{position:fixed;width:15vh;height:20vh;background:radial-gradient(2vh at 90% 50%,gold 35%,transparent 40%),#a22;border-radius:1vh 1vh 0 0;transform-origin:0% 100%;transform:translateX(-7.5vh)translateY(-12.5vh)rotateX(-90deg);text-align:center;font-size:6vh;line-height:12vh;color:#fff;transition:transform 1s}.do .y.d1{background:radial-gradient(2vh at 90% 50%,gold 35%,transparent 40%),#222}.do.s .y{transform:translateX(-7.5vh)translateY(-12.5vh)rotateX(-90deg)rotateY(90deg)}.z.x div{background:linear-gradient(45deg,#640,#583808)}.z.x div.u{transform:rotateY(90deg)translateX(-5.4vh)translateZ(-.1vh)rotateY(-90deg);background:radial-gradient(#3F7D1F,#034301);background-size:280vh 140vh;width:5.3vh;height:5.3vh}.t{position:fixed;background:#fff;padding:.7vh;width:20vh;font:2vh/2.5vh arial,sans-serif;transform-origin:50% 100%;text-align:center;box-shadow:0 0 0 .2vh #000 inset;bottom:0}.t br{font:0/0 a}.t:before{content:"";width:3vh;height:3vh;background:#750;position:absolute;bottom:-3vh;left:8vh;border-left:.2vh solid;border-right:.2vh solid}.pz .t:before{left:28vh}label{text-align:left}#a{transition:transform 6s ease-in,transform-origin 6s ease-in;width:280vh;height:140vh;background:radial-gradient(#4F8D2F,#136321);border-radius:3vh}.px #a,.pI #a{background:radial-gradient(10vh at 51.3% 52%,#000 40%,transparent 50%),radial-gradient(15vh at 51.3% 52%,#640 40%,transparent 50%),radial-gradient(#4F8D2F,#136321)}#e{margin:99vh 0 0;transition:margin 1s;font:10vh/80vh a}#iw{font:5vh arial,sans-serif;color:#fff;position:fixed;bottom:9vh;left:0;width:100vw}#menu{color:#fff;width:55vh;transform:translateX(-27vh)translateY(-20vh)rotateX(-17deg)}#menu span{font:7vh/12vh arial,sans-serif}#menu h1{font:13vh/16vh arial,sans-serif;text-shadow:.1vh -.1vh #777,.2vh -.2vh #777,.3vh -.3vh #777}#menu span:hover{color:#ace;transform:rotateX(-10deg)}.pN #menu span:hover{color:#fff}#iz button{position:fixed;width:10vh;height:10vh;text-align:center;font:6vh/10vh a}#kU{right:14vh;bottom:14vh}#kD{right:14vh;bottom:2vh}#kL{right:26vh;bottom:2vh}#kR{right:2vh;bottom:2vh}#kT{left:2vh;top:2vh}#kB{left:2vh;top:14vh}#kw{bottom:2vh;left:2vh}#kx{bottom:14vh;left:2vh}#ky{top:2vh;right:18vh}#kz{top:2vh;right:6vh}#hpx0{opacity:0;transition:opacity .5s}</style><body id=b style=background:#000>